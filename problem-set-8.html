<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 1 Problem Set 8 | PS8.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 1 Problem Set 8 | PS8.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 1 Problem Set 8 | PS8.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>


<link rel="stylesheet" href="m236.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">MATH 236: Linear Algebra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#problem-set-8"><i class="fa fa-check"></i><b>1</b> Problem Set 8</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#subspace-projection"><i class="fa fa-check"></i><b>1.1</b> Subspace Projection</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#least-squares-polynomials"><i class="fa fa-check"></i><b>1.2</b> Least-Squares Polynomials</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#fuel-efficiency"><i class="fa fa-check"></i><b>1.3</b> Fuel Efficiency</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#fourier-analysis"><i class="fa fa-check"></i><b>1.4</b> Fourier Analysis</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#global-fossil-fuel-emissions"><i class="fa fa-check"></i><b>1.5</b> Global Fossil Fuel Emissions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="problem-set-8" class="section level1" number="1">
<h1><span class="header-section-number">Section 1</span> Problem Set 8</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(pracma)</span></code></pre></div>
<pre><code>## Loading required package: pracma</code></pre>
<p>Download the <a href="https://raw.githubusercontent.com/Tom-Halverson/math236_s21/main/PS8.Rmd">Rmd source file for this problem set</a>.</p>
<p>Upload a completed, knitted .html version of this file on Moodle. If you have collaborated with others on this assignment (encouraged), please include their names here (no penalty).</p>
<div id="subspace-projection" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Subspace Projection</h2>
<p>Last week we learned how to project onto a subspace, but our method required that we have an orthogonal basis. Here we will see that our least-squares method allows us to project onto a subspace with any (not-necessarily-orthgoonal) basis. Consider the following subspace of <span class="math inline">\(\mathbb{R}^4\)</span>. We can turn it into a least-squares problem by making it the column space of a matrix <span class="math inline">\(A\)</span>. That is <span class="math inline">\(W = Col(A)\)</span>.
<span class="math display">\[
W = span\left\{
\begin{bmatrix} 1 \\ 2 \\ -1 \\ -2 \end{bmatrix}, 
\begin{bmatrix} 1 \\ 2 \\ 3 \\ 4 \end{bmatrix}, 
\begin{bmatrix} 1 \\ 0 \\ 1 \\ 0 \end{bmatrix}
\right\}, \hskip.6in
b = \begin{bmatrix} 9 \\ 5 \\ 5 \\ 8 \end{bmatrix}.
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">A =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    1
## [2,]    2    2    0
## [3,]   -1    3    1
## [4,]   -2    4    0</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">8</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Perform a matrix computation on A to show that the basis is not orthogonal.</p></li>
<li><p>Show that b is not in W.</p></li>
<li><p>Find the least-squares projection of b onto W. Find both <span class="math inline">\(\hat x\)</span> and <span class="math inline">\(\hat b\)</span>.</p></li>
<li><p>Calculate the residual vector r, show that <span class="math inline">\(r \in W^\perp\)</span>, and find <span class="math inline">\(||r||\)</span>.</p></li>
<li><p>Consider the following derivation from the normal equations:
<span class="math display">\[
A^T A x = A^T b \qquad \Longrightarrow \qquad \hat x = (A^T A)^{-1} A^T b.
\]</span>
The <strong>pseudoinverse</strong> is the matrix
<span class="math display">\[
A^+ = (A^T A)^{-1} A^T
\]</span>
From what we see above it gives the <em>least-squares</em> solution to <span class="math inline">\(A x = b\)</span>. Compute the matrix <span class="math inline">\(A^+\)</span>, multiply it by <span class="math inline">\(b\)</span>, and show that you get <span class="math inline">\(\hat x\)</span>.</p></li>
<li><p>Continuing this story,
<span class="math display">\[
\hat b = A \hat x \qquad \Longrightarrow \qquad \hat b =  A (A^T A)^{-1} A^T b.
\]</span>
The <strong>projection</strong> matrix onto the subspace <span class="math inline">\(W\)</span> is the matrix
<span class="math display">\[
P = A (A^T A)^{-1} A^T.
\]</span>
Compute the matrix <span class="math inline">\(P\)</span>, apply it to <span class="math inline">\(b\)</span>, and see that you get the projected value <span class="math inline">\(\hat b\)</span>.</p></li>
<li><p>Compute <span class="math inline">\(P^2\)</span> and compare it to <span class="math inline">\(P\)</span>. Explain why this happens.</p></li>
<li><p>Use <span class="math inline">\(P\)</span> to project the vector <code>b2 = c(1,2,3,4)</code> onto <span class="math inline">\(W\)</span>.</p></li>
<li><p>Find the eigenvalues of <span class="math inline">\(P\)</span>. They are nice. Explain (briefly) where the eigenvectors of this matrix are in relation to <span class="math inline">\(W\)</span>.</p></li>
</ol>
</div>
<div id="least-squares-polynomials" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Least-Squares Polynomials</h2>
<p>Here is the problem that we discussed in class with a quadratic fit to it. Make a cubic, quartic, and quintic fit to this data. Turn in a plot of each. Comupute the length of the residual in each case. Which do you think is the best model of the data?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">A =</span> <span class="fu">cbind</span>(x<span class="sc">^</span><span class="dv">0</span>,x,x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        x   
## [1,] 1 1  1
## [2,] 1 2  4
## [3,] 1 3  9
## [4,] 1 4 16
## [5,] 1 5 25
## [6,] 1 6 36</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xhat <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(A)<span class="sc">%*%</span>A,<span class="fu">t</span>(A)<span class="sc">%*%</span>y)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> A <span class="sc">%*%</span> xhat</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> y <span class="sc">-</span> yhat</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(r) <span class="sc">%*%</span> r</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 11.26429</code></pre>
<p><img src="PS8_files/figure-html/ps8-quadplot-1.png" width="432" /></p>
</div>
<div id="fuel-efficiency" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Fuel Efficiency</h2>
<p>Below is a classic data set of fuel efficiency in 38 different automobiles.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MPG<span class="ot">=</span><span class="fu">c</span>(<span class="fl">16.9</span>,<span class="fl">15.5</span>,<span class="fl">19.2</span>,<span class="fl">18.5</span>,<span class="dv">30</span>,<span class="fl">27.5</span>,<span class="fl">27.2</span>,<span class="fl">30.9</span>,<span class="fl">20.3</span>,<span class="dv">17</span>,<span class="fl">21.6</span>,<span class="fl">16.2</span>,<span class="fl">20.6</span>,<span class="fl">20.8</span>,<span class="fl">18.6</span>,<span class="fl">18.1</span>,<span class="dv">17</span>,<span class="fl">17.6</span>,<span class="fl">16.5</span>,<span class="fl">18.2</span>,<span class="fl">26.5</span>,<span class="fl">21.9</span>,<span class="fl">34.1</span>,<span class="fl">35.1</span>,<span class="fl">27.4</span>,<span class="fl">31.5</span>,<span class="fl">29.5</span>,<span class="fl">28.4</span>,<span class="fl">28.8</span>,<span class="fl">26.8</span>,<span class="fl">33.5</span>,<span class="fl">34.2</span>,<span class="fl">31.8</span>,<span class="fl">37.3</span>,<span class="fl">30.5</span>,<span class="dv">22</span>,<span class="fl">21.5</span>,<span class="fl">31.9</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>lbs<span class="ot">=</span><span class="fu">c</span>( <span class="fl">3967.6</span>,<span class="fl">3689.14</span>,<span class="fl">3280.55</span>,<span class="fl">3585.4</span>,<span class="fl">1961.05</span>,<span class="fl">2329.6</span>,<span class="dv">2093</span>,<span class="fl">2029.3</span>,<span class="fl">2575.3</span>,<span class="fl">2857.4</span>,<span class="fl">2543.45</span>,<span class="fl">3103.1</span>,<span class="fl">3075.8</span>,<span class="fl">2793.7</span>,<span class="fl">3294.2</span>,<span class="fl">3103.1</span>,<span class="fl">3494.4</span>,<span class="fl">3389.75</span>,<span class="fl">3599.05</span>,<span class="fl">3485.3</span>,<span class="fl">2352.35</span>,<span class="fl">2648.1</span>,<span class="fl">1797.25</span>,<span class="fl">1742.65</span>,<span class="fl">2429.7</span>,<span class="fl">1810.9</span>,<span class="fl">1942.85</span>,<span class="fl">2429.7</span>,<span class="fl">2361.45</span>,<span class="dv">2457</span>,<span class="fl">2325.96</span>,<span class="dv">2002</span>,<span class="fl">1838.2</span>,<span class="fl">1938.3</span>,<span class="fl">1992.9</span>,<span class="fl">2561.65</span>,<span class="dv">2366</span>,<span class="dv">1925</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>HP<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">155</span>,<span class="dv">142</span>,<span class="dv">125</span>,<span class="dv">150</span>,<span class="dv">68</span>,<span class="dv">95</span>,<span class="dv">97</span>,<span class="dv">75</span>,<span class="dv">103</span>,<span class="dv">125</span>,<span class="dv">115</span>,<span class="dv">133</span>,<span class="dv">105</span>,<span class="dv">85</span>,<span class="dv">110</span>,<span class="dv">120</span>,<span class="dv">130</span>,<span class="dv">129</span>,<span class="dv">138</span>,<span class="dv">135</span>,<span class="dv">88</span>,<span class="dv">109</span>,<span class="dv">65</span>,<span class="dv">80</span>,<span class="dv">80</span>,<span class="dv">71</span>,<span class="dv">68</span>,<span class="dv">90</span>,<span class="dv">115</span>,<span class="dv">115</span>,<span class="dv">90</span>,<span class="dv">70</span>,<span class="dv">65</span>,<span class="dv">69</span>,<span class="dv">78</span>,<span class="dv">97</span>,<span class="dv">110</span>,<span class="dv">71</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Cyl<span class="ot">=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Car <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;BuickEstateWagon&quot;</span>, <span class="st">&quot;FordCountrySquireWagon&quot;</span>, <span class="st">&quot;ChevyMalibuWagon&quot;</span>, <span class="st">&quot;ChryslerLeBaronWagon&quot;</span>, <span class="st">&quot;Chevette&quot;</span>, <span class="st">&quot;ToyotaCorona&quot;</span>, <span class="st">&quot;Datsun510&quot;</span>, <span class="st">&quot;DodgeOmni&quot;</span>, <span class="st">&quot;Audi5000&quot;</span>, <span class="st">&quot;Volvo240GL&quot;</span>, <span class="st">&quot;Saab99GLE&quot;</span>, <span class="st">&quot;Peugeot694SL&quot;</span>, <span class="st">&quot;BuickCenturySpecial&quot;</span>, <span class="st">&quot;MercuryZephyr&quot;</span>, <span class="st">&quot;DodgeAspen&quot;</span>, <span class="st">&quot;AMCConcordD/L&quot;</span>, <span class="st">&quot;ChevyCapriceClassic&quot;</span>, <span class="st">&quot;FordLTD&quot;</span>, <span class="st">&quot;MercuryGrandMarquis&quot;</span>, <span class="st">&quot;DodgeStRegis&quot;</span>, <span class="st">&quot;FordMustang4&quot;</span>, <span class="st">&quot;FordMustangGhia&quot;</span>, <span class="st">&quot;MazdaGLC&quot;</span>, <span class="st">&quot;DodgeColt&quot;</span>, <span class="st">&quot;AMCSpirit&quot;</span>, <span class="st">&quot;VWScirocco&quot;</span>, <span class="st">&quot;HondaAccordLX&quot;</span>, <span class="st">&quot;BuickSkylark&quot;</span>, <span class="st">&quot;ChevyCitation&quot;</span>, <span class="st">&quot;OldsOmega&quot;</span>, <span class="st">&quot;PontiacPhoenix&quot;</span>, <span class="st">&quot;PlymouthHorizon&quot;</span>, <span class="st">&quot;Datsun210&quot;</span>, <span class="st">&quot;FiatStrada&quot;</span>, <span class="st">&quot;VWDasher&quot;</span>, <span class="st">&quot;Datsun810&quot;</span>, <span class="st">&quot;BMW320i&quot;</span>, <span class="st">&quot;VWRabbit&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(lbs,HP,Cyl,MPG)) <span class="co">#Convert to data frame</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df)<span class="ot">=</span>Car</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##                            lbs  HP Cyl  MPG
## BuickEstateWagon       3967.60 155   8 16.9
## FordCountrySquireWagon 3689.14 142   8 15.5
## ChevyMalibuWagon       3280.55 125   8 19.2
## ChryslerLeBaronWagon   3585.40 150   8 18.5
## Chevette               1961.05  68   4 30.0
## ToyotaCorona           2329.60  95   4 27.5
## Datsun510              2093.00  97   4 27.2
## DodgeOmni              2029.30  75   4 30.9
## Audi5000               2575.30 103   5 20.3
## Volvo240GL             2857.40 125   6 17.0
## Saab99GLE              2543.45 115   4 21.6
## Peugeot694SL           3103.10 133   6 16.2
## BuickCenturySpecial    3075.80 105   6 20.6
## MercuryZephyr          2793.70  85   6 20.8
## DodgeAspen             3294.20 110   6 18.6
## AMCConcordD/L          3103.10 120   6 18.1
## ChevyCapriceClassic    3494.40 130   8 17.0
## FordLTD                3389.75 129   8 17.6
## MercuryGrandMarquis    3599.05 138   8 16.5
## DodgeStRegis           3485.30 135   8 18.2
## FordMustang4           2352.35  88   4 26.5
## FordMustangGhia        2648.10 109   6 21.9
## MazdaGLC               1797.25  65   4 34.1
## DodgeColt              1742.65  80   4 35.1
## AMCSpirit              2429.70  80   4 27.4
## VWScirocco             1810.90  71   4 31.5
## HondaAccordLX          1942.85  68   4 29.5
## BuickSkylark           2429.70  90   4 28.4
## ChevyCitation          2361.45 115   6 28.8
## OldsOmega              2457.00 115   6 26.8
## PontiacPhoenix         2325.96  90   4 33.5
## PlymouthHorizon        2002.00  70   4 34.2
## Datsun210              1838.20  65   4 31.8
## FiatStrada             1938.30  69   4 37.3
## VWDasher               1992.90  78   4 30.5
## Datsun810              2561.65  97   6 22.0
## BMW320i                2366.00 110   4 21.5
## VWRabbit               1925.00  71   4 31.9</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Fit a linear model of the form
<span class="math display">\[
mpg = a_0 + a_1 lbs + a_2 HP + a_3 Cyl.
\]</span>
Find the coefficients <span class="math inline">\(a_0,a_1,a_2,a_3\)</span> and the length of the residual. If you have taken Stat 155, you can see that we are doing the exact same thing by comparing your results with</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cars_lm <span class="ot">=</span> <span class="fu">lm</span>( MPG <span class="sc">~</span> lbs <span class="sc">+</span> HP <span class="sc">+</span> Cyl)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cars_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = MPG ~ lbs + HP + Cyl)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4669 -1.6011 -0.3246  1.0759  6.6231 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 49.644579   1.992433  24.917  &lt; 2e-16 ***
## lbs         -0.008288   0.002316  -3.579  0.00106 ** 
## HP          -0.073961   0.043862  -1.686  0.10091    
## Cyl          0.791590   0.730326   1.084  0.28604    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.791 on 34 degrees of freedom
## Multiple R-squared:  0.833,  Adjusted R-squared:  0.8183 
## F-statistic: 56.55 on 3 and 34 DF,  p-value: 2.656e-13</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Add the cars weight in tons to your model and solve <span class="math inline">\(mpg = a_0 + a_1 (lbs) + a_2 (HP) + a_3 (Cyl) + a_4 (tons).\)</span> Compare the coefficients you get with those that you got in part a. Give a short explanation of what you see using some of the linear algebra language that we have learned in the course.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tons <span class="ot">=</span>  <span class="fu">c</span>(<span class="fl">1.98</span>, <span class="fl">1.84</span>, <span class="fl">1.64</span>, <span class="fl">1.79</span>, <span class="fl">0.98</span>, <span class="fl">1.16</span>, <span class="fl">1.05</span>, <span class="fl">1.01</span>, <span class="fl">1.29</span>, <span class="fl">1.43</span>, <span class="fl">1.27</span>, <span class="fl">1.55</span>, <span class="fl">1.54</span>, <span class="fl">1.40</span>, <span class="fl">1.65</span>, <span class="fl">1.55</span>, <span class="fl">1.75</span>, <span class="fl">1.69</span>, <span class="fl">1.80</span>, <span class="fl">1.74</span>, <span class="fl">1.18</span>, <span class="fl">1.32</span>, <span class="fl">0.90</span>, <span class="fl">0.87</span>, <span class="fl">1.21</span>, <span class="fl">0.91</span>,<span class="fl">0.97</span>, <span class="fl">1.21</span>, <span class="fl">1.18</span>, <span class="fl">1.23</span>, <span class="fl">1.16</span>, <span class="fl">1.00</span>, <span class="fl">0.92</span>, <span class="fl">0.97</span>, <span class="fl">1.00</span>, <span class="fl">1.28</span>, <span class="fl">1.18</span>, <span class="fl">0.96</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>The residual vector <span class="math inline">\(\mathsf{r}\)</span> measures the quality of fit of our model. But how do we turn this into a meaningful quantity? One method is to look at the <strong>coefficient of determination</strong>, which is more commonly refered to as the “<span class="math inline">\(R^2\)</span> value.”</li>
</ol>
<ul>
<li><p>You can see the <span class="math inline">\(R^2\)</span> value of your fit in part (a) under the “Multiple R-squared” output in the linear model summary above.</p></li>
<li><p>If <span class="math inline">\(\mathsf{y} = [ y_1, y_2, \ldots, y_n ]^{\top}\)</span> is our target vector with least-squares solution <span class="math inline">\(\hat{\mathsf{y}} = A \hat{\mathsf{x}}\)</span> and residual vector is <span class="math inline">\(\mathsf{r} = \mathsf{y} - \hat{\mathsf{y}}\)</span>. Let
<span class="math display">\[
a = \frac{1}{n} ( y_1 + y_2 + \cdots + y_n)
\]</span>
be the average or mean of the entries of target vector <span class="math inline">\(\mathsf{y}\)</span> and let <span class="math inline">\(\mathsf{y}^* = [a, a, \ldots, a]\)</span>. (We call this vector “y star”, so <code>ystar</code> would be a fine name in R.) The <span class="math inline">\(R^2\)</span> value is
<span class="math display">\[
R^2 = 1 - \frac{\| \mathsf{y} - \hat{\mathsf{y}} \|^2 }{\| \mathsf{y} - \mathsf{y}^* \|^2} = 1 - \frac{\| \mathsf{r} \|^2}{\| \mathsf{y} - \mathsf{y}^* \|^2}.
\]</span></p></li>
<li><p>The <span class="math inline">\(R^2\)</span> value is a number in <span class="math inline">\([0,1]\)</span>. The squared-length <span class="math inline">\(|| \mathsf{y} -\mathsf{y}^*||^2\)</span> is the total variance: that is, how much the data varies from the mean, and <span class="math inline">\(\frac{\| \mathsf{r} \|^2}{\| \mathsf{y} - \mathsf{y}^* \|^2}\)</span> tells us the fraction of the total variance that is explained by our model. Thus, if <span class="math inline">\(R^2\)</span> is near 1, then our model does a good job at “explaining” the behavior of <span class="math inline">\(\mathsf{y}\)</span> via a linear combination of the columns of <span class="math inline">\(A\)</span>.</p></li>
<li><p><strong>To do</strong>: Find the <span class="math inline">\(R^2\)</span> value for our least squares solution to the cars data in part (a). Here are some helpful functions:
+ <code>mean(vec)</code> returns the mean (average) of the entries of the vector <code>vec</code>
+ <code>rep(a, n)</code> creates a constant vector of length <span class="math inline">\(n\)</span> where every entry is <span class="math inline">\(a\)</span>.
+ <code>Norm(vec)</code> from the <code>pracma</code> package returns the magnitude (Euclidean length) of the vector <code>vec</code>.
To learn more, you should take STAT 155: Introduction to Statistical Modeling.</p></li>
</ul>
</div>
<div id="fourier-analysis" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Fourier Analysis</h2>
<p>In Fourier analysis one uses trigonometric functions to model oscillatory behavior in data. These methods have important applications in the study of sound or video signals, financial data, medicine, and engineering (to mention just a few). For example, consider the following set of 200 data points.
<img src="PS8_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>A first Fourier approximation would fit a model of the form
<span class="math display">\[
f_1(t) = c_0 + c_1 \sin(t) + c_2 \cos(t).
\]</span>
Thus, we make the following matrix (we show here only the first 10 rows; there are 200 rows).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">cbind</span>(t<span class="sc">^</span><span class="dv">0</span>, <span class="fu">sin</span>(t),<span class="fu">cos</span>(t))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##       [,1]       [,2]      [,3]
##  [1,]    1 0.00000000 1.0000000
##  [2,]    1 0.09983342 0.9950042
##  [3,]    1 0.19866933 0.9800666
##  [4,]    1 0.29552021 0.9553365
##  [5,]    1 0.38941834 0.9210610
##  [6,]    1 0.47942554 0.8775826
##  [7,]    1 0.56464247 0.8253356
##  [8,]    1 0.64421769 0.7648422
##  [9,]    1 0.71735609 0.6967067
## [10,]    1 0.78332691 0.6216100</code></pre>
<p>Now we solve the normal equations</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">xhat =</span> <span class="fu">solve</span>(<span class="fu">t</span>(A) <span class="sc">%*%</span> A, <span class="fu">t</span>(A) <span class="sc">%*%</span> y))</span></code></pre></div>
<pre><code>##            [,1]
## [1,]  3.9971143
## [2,]  1.0207277
## [3,] -0.4486618</code></pre>
<p>and plot the solution
<img src="PS8_files/figure-html/unnamed-chunk-10-1.png" width="672" />
Your task:</p>
<ol style="list-style-type: lower-alpha">
<li>Update this to add the second Fourier coefficient terms by fitting the following function to the data. Plot your result.
<span class="math display">\[
f_2(t) = c_0 + c_1 \sin(t) + c_2 \cos(t) + c_3 \sin(2t) + c_4 \cos(2t)
\]</span></li>
<li>Compute the length of the residul vector for both the <span class="math inline">\(f_1(t)\)</span> and the <span class="math inline">\(f_2(t)\)</span> model. Which approximation looks better visually. That is, does the second approximation capture more of the shape of the data, or do you think that the first is a better model?</li>
</ol>
</div>
<div id="global-fossil-fuel-emissions" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Global Fossil Fuel Emissions</h2>
<p>Below is a plot of global fossil fuel emmissions between 1751 and 1998 measured in megatons of carbon.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>year<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1751</span><span class="sc">:</span><span class="dv">1998</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>emissions <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">29</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">39</span>, <span class="dv">43</span>, <span class="dv">43</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">50</span>, <span class="dv">54</span>, <span class="dv">54</span>, <span class="dv">57</span>, <span class="dv">59</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">83</span>, <span class="dv">91</span>, <span class="dv">95</span>, <span class="dv">97</span>, <span class="dv">104</span>, <span class="dv">112</span>, <span class="dv">119</span>, <span class="dv">122</span>, <span class="dv">130</span>, <span class="dv">135</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dv">142</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">173</span>, <span class="dv">184</span>, <span class="dv">174</span>, <span class="dv">188</span>, <span class="dv">191</span>, <span class="dv">194</span>, <span class="dv">196</span>, <span class="dv">210</span>, <span class="dv">236</span>, <span class="dv">243</span>, <span class="dv">256</span>, <span class="dv">272</span>, <span class="dv">275</span>, <span class="dv">277</span>, <span class="dv">281</span>, <span class="dv">295</span>, <span class="dv">327</span>, <span class="dv">327</span>, <span class="dv">356</span>, <span class="dv">372</span>, <span class="dv">374</span>, <span class="dv">370</span>, <span class="dv">383</span>, <span class="dv">406</span>, <span class="dv">419</span>, <span class="dv">440</span>, <span class="dv">465</span>, <span class="dv">507</span>, <span class="dv">534</span>, <span class="dv">552</span>, <span class="dv">566</span>, <span class="dv">617</span>, <span class="dv">624</span>, <span class="dv">663</span>, <span class="dv">707</span>, <span class="dv">784</span>, <span class="dv">750</span>, <span class="dv">785</span>, <span class="dv">819</span>, <span class="dv">836</span>, <span class="dv">879</span>, <span class="dv">943</span>, <span class="dv">850</span>, <span class="dv">838</span>, <span class="dv">901</span>, <span class="dv">955</span>, <span class="dv">936</span>, <span class="dv">806</span>, <span class="dv">932</span>, <span class="dv">803</span>, <span class="dv">845</span>, <span class="dv">970</span>, <span class="dv">963</span>, <span class="dv">975</span>, <span class="dv">983</span>, <span class="dv">1062</span>, <span class="dv">1065</span>, <span class="dv">1145</span>, <span class="dv">1053</span>, <span class="dv">940</span>, <span class="dv">847</span>, <span class="dv">893</span>, <span class="dv">973</span>, <span class="dv">1027</span>, <span class="dv">1130</span>, <span class="dv">1209</span>, <span class="dv">1142</span>, <span class="dv">1192</span>, <span class="dv">1299</span>, <span class="dv">1334</span>, <span class="dv">1342</span>, <span class="dv">1391</span>, <span class="dv">1383</span>, <span class="dv">1160</span>, <span class="dv">1238</span>, <span class="dv">1392</span>, <span class="dv">1469</span>, <span class="dv">1419</span>, <span class="dv">1630</span>, <span class="dv">1767</span>, <span class="dv">1795</span>, <span class="dv">1841</span>, <span class="dv">1865</span>, <span class="dv">2043</span>, <span class="dv">2177</span>, <span class="dv">2270</span>, <span class="dv">2330</span>, <span class="dv">2463</span>, <span class="dv">2578</span>, <span class="dv">2595</span>, <span class="dv">2701</span>, <span class="dv">2848</span>, <span class="dv">3009</span>, <span class="dv">3146</span>, <span class="dv">3306</span>, <span class="dv">3412</span>, <span class="dv">3588</span>, <span class="dv">3802</span>, <span class="dv">4075</span>, <span class="dv">4227</span>, <span class="dv">4394</span>, <span class="dv">4633</span>, <span class="dv">4641</span>, <span class="dv">4613</span>, <span class="dv">4879</span>, <span class="dv">5018</span>, <span class="dv">5078</span>, <span class="dv">5368</span>, <span class="dv">5297</span>, <span class="dv">5125</span>, <span class="dv">5080</span>, <span class="dv">5067</span>, <span class="dv">5241</span>, <span class="dv">5405</span>, <span class="dv">5573</span>, <span class="dv">5701</span>, <span class="dv">5926</span>, <span class="dv">6035</span>, <span class="dv">6096</span>, <span class="dv">6186</span>, <span class="dv">6089</span>, <span class="dv">6090</span>, <span class="dv">6236</span>, <span class="dv">6378</span>, <span class="dv">6530</span>, <span class="dv">6628</span>, <span class="dv">6608</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year,emissions,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">cex=</span>.<span class="dv">7</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="PS8_files/figure-html/sqemission-1.png" width="672" /></p>
<p>The data suggest that the fossil fuel emissions <span class="math inline">\(f\)</span> follow an exponential model with respect to the year <span class="math inline">\(y\)</span>:
<span class="math display">\[f = a e^{k(y-1750)},\]</span>
where <span class="math inline">\(a\)</span> and <span class="math inline">\(k\)</span> are the unknown constants. This model is not linear in the unknowns <span class="math inline">\(a\)</span> and <span class="math inline">\(k\)</span>, but (this is a great idea!) it becomes linear if we take the logarithm of both sides. Doing so yields the following linear system:
<span class="math display">\[\log(f)=\log(a)+k(y-1750).\]</span></p>
<ul>
<li><strong>Note:</strong> This process works for any logarithm, but it is common to use the natural logarithm (use <code>log()</code> in R).</li>
<li><strong>Note:</strong> To simplify even further, we will define <code>time=year-1750</code> so that time represents years after 1750.</li>
</ul>
<p>This results in the model</p>
<p><span class="math display">\[ \log(f)=d+kt,\]</span>
where <span class="math inline">\(d=\log(a)\)</span> and <span class="math inline">\(t\)</span> is time (since 1750),</p>
<p>Your task: Use least-squares projection to find the best fitting exponential function for this data. This will give you the values for <span class="math inline">\(d\)</span> and <span class="math inline">\(k\)</span>, and once you know <span class="math inline">\(d\)</span>, you can find <span class="math inline">\(a = \exp(d)\)</span>. We have started the code for you by defining <code>x=year-1750</code> and <code>y=log(emissions)</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">### your code goes here. </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># be sure to define d and k and A</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span>year<span class="dv">-1750</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">log</span>(emissions)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">cbind</span>(<span class="dv">1</span>)  <span class="co"># this isn&#39;t right, yet!</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># your code above has found b and k</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>(<span class="at">a =</span> <span class="fu">exp</span>(d))</span></code></pre></div>
<pre><code>## [1] 2.718282</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>k</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Run the code below to plot the original data along with your exponential model curve <span class="math inline">\(f(t)\)</span>. <strong>Note:</strong> This code assumes that you have already defined the values for <code>k</code> and <code>a</code>. Otherwise, it will not work!</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">=</span><span class="cf">function</span>(y){a <span class="sc">*</span> <span class="fu">exp</span>(k<span class="sc">*</span>(y<span class="dv">-1750</span>))}</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(year,<span class="fu">f</span>(year),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10000</span>),<span class="at">ylab=</span><span class="st">&quot;emissions&quot;</span>, <span class="at">main=</span><span class="st">&quot;best fit exponential function&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(year,emissions,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">cex=</span>.<span class="dv">7</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="PS8_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
